<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Online Exam System</title>

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:"Poppins",sans-serif;}
body{
  min-height:100vh;
  background:url('background.webp') center/cover no-repeat;
  display:flex;justify-content:center;align-items:center;
  transition:background 0.8s ease;
}
body.dark{
  background:url('dark.webp') center/cover no-repeat;
  color:black;
}

.container{
  background:rgba(255,255,255,0.9);
  padding:30px;border-radius:20px;
  box-shadow:0 5px 20px rgba(0,0,0,0.3);
  width:90%;max-width:600px;text-align:center;
  animation:fadeIn 0.6s ease-in-out;
}
@keyframes fadeIn{from{opacity:0;transform:translateY(15px);}to{opacity:1;transform:translateY(0);}}

/* Buttons */
button{
  padding:12px 20px;background:#6a5acd;color:#fff;border:none;
  border-radius:8px;cursor:pointer;font-weight:bold;
  transition:all .3s;margin-top:10px;
}
button:hover{background:#5b4cc4;transform:scale(1.05);}

.dark-toggle{
  position:absolute;top:20px;right:20px;
  background:#333;color:#fff;padding:6px 14px;border-radius:20px;
  cursor:pointer;font-size:.9em;
}

/* Login Page */
.login-container input{
  width:100%;padding:12px;margin:8px 0;
  border-radius:8px;border:1px solid #ccc;
}

/* Subject Page */
.subject-container{display:none;flex-direction:column;align-items:center;gap:25px;}
.subject-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:20px;width:100%;
}
.subject-card{
  background:rgba(255,255,255,0.85);
  border-radius:15px;padding:25px;
  box-shadow:0 4px 15px rgba(0,0,0,0.1);
  cursor:pointer;text-align:center;font-weight:bold;
  transition:all 0.3s;
}
.subject-card:hover{transform:translateY(-5px);background:#e0d8ff;}
.dark .subject-card{background:rgba(0,0,0,0.5);}
.dark .subject-card:hover{background:rgba(100,100,100,0.7);}

/* Exam Page */
.exam-container{display:none;flex-direction:column;width:100%;max-width:800px;}
.question{font-size:1.2em;text-align:left;margin:20px 0;color:#222;}
.options{display:flex;flex-direction:column;align-items:flex-start;gap:10px;}
.option-label{
  display:flex;align-items:center;gap:10px;
  background:#f5f5f5;width:100%;padding:10px 15px;
  border-radius:10px;cursor:pointer;transition:.3s;
}
.option-label:hover{background:#d9e4ff;}
.option-label span.option-tag{
  display:inline-block;background:#6a5acd;color:#fff;
  border-radius:50%;width:25px;height:25px;line-height:25px;
  text-align:center;font-weight:bold;
}
input[type="radio"]{accent-color:#6a5acd;}

/* Timer */
#timer{
  text-align:center;font-weight:bold;color:white;
  background:#6a5acd;border-radius:10px;padding:8px;margin-bottom:10px;
}

/* Scoreboard */
.score-circle{
  width:150px;height:150px;border-radius:50%;
  border:10px solid #ccc;position:relative;margin:20px auto;
}
.score-fill{
  width:150px;height:150px;border-radius:50%;
  border:10px solid #2ecc71;clip-path:polygon(0 100%,100% 100%,100% 0);
  position:absolute;top:0;left:0;transform:rotate(0deg);
  transform-origin:center;transition:transform 1s linear;
}
.score-value{
  position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
  font-size:1.5em;font-weight:bold;color:#333;
}

/* Teacher Table */
table{width:100%;border-collapse:collapse;margin-top:20px;}
th,td{border:1px solid #ccc;padding:8px;text-align:center;}
th{background:#6a5acd;color:#fff;}
</style>
</head>
<body>

<div class="dark-toggle" onclick="toggleDark()">üåô Dark Mode</div>

<!-- LOGIN PAGE -->
<div class="login-container container" id="loginPage">
  <h2>Online Exam Login</h2>
  <input type="text" id="userId" placeholder="Enter Student ID">
  <input type="password" id="userPass" placeholder="Enter Password">
  <button onclick="studentLogin()">Login as Student</button>
  <p>or</p>
  <button onclick="teacherLogin()">Login as Teacher</button>
</div>

<!-- SUBJECT PAGE -->
<div class="subject-container container" id="subjectPage">
  <h2>Select Subject</h2>
  <div class="subject-grid">
    <div class="subject-card" onclick="startExam('AIML')">ü§ñ AIML</div>
    <div class="subject-card" onclick="startExam('OS')">üíª Operating Systems</div>
    <div class="subject-card" onclick="startExam('OOP')">üß© OOP</div>
    <div class="subject-card" onclick="startExam('DBMS')">üóÑÔ∏è DBMS</div>
  </div>
  <button onclick="logout()">Logout</button>
</div>

<!-- EXAM PAGE -->
<div class="exam-container container" id="examPage">
  <h2 id="examTitle"></h2>
  <div id="timer">Time Left: 30:00</div>
  <div id="questionContainer"></div>
  <div style="display:flex;justify-content:space-between;margin-top:20px;">
    <button onclick="prevQuestion()">‚¨ÖÔ∏è Previous</button>
    <button onclick="nextQuestion()">Next ‚û°Ô∏è</button>
  </div>
  <button style="margin-top:25px;" onclick="confirmSubmit()">Submit Exam</button>
</div>

<!-- RESULT PAGE -->
<div class="container" id="resultPage" style="display:none;">
  <h2>Exam Result</h2>
  <div class="score-circle">
    <div class="score-fill" id="scoreFill"></div>
    <div class="score-value" id="scoreValue">0%</div>
  </div>
  <p id="resultText"></p>
  <button onclick="backToSubjects()">Back to Subjects</button>
</div>

<!-- TEACHER PAGE -->
<div class="container" id="teacherPage" style="display:none;">
  <h2>Teacher Dashboard</h2>
  <table id="resultTable">
    <tr><th>Student ID</th><th>Subject</th><th>Score</th><th>Date</th></tr>
  </table>
  <button onclick="logout()">Logout</button>
</div>

<script>
const studentPass="student123",teacherPass="teacher456";
let currentUser="",currentSubject="",currentIndex=0,timer=1800,timerInterval;
let answers=[],questions=[],examStart;

// SUBJECT QUESTIONS
const questionBank={
  AIML:[
    {q:"Which algorithm is used for training deep neural networks?",opts:["Gradient Descent","Decision Tree","K-Means","Naive Bayes"],a:0},
    {q:"Which of these is a supervised learning technique?",opts:["Clustering","Classification","Association","Anomaly detection"],a:1},
    {q:"Perceptron is a type of:",opts:["Reinforcement model","Neural network","SVM","Decision Tree"],a:1},
    {q:"What is overfitting?",opts:["Good generalization","Poor generalization","High bias","None"],a:1},
    {q:"Which library is used for ML in Python?",opts:["NumPy","TensorFlow","Pandas","Flask"],a:1},
    {q:"Reinforcement learning uses:",opts:["Labels","Rewards","Supervision","None"],a:1},
    {q:"Which is not a type of ML?",opts:["Supervised","Unsupervised","Iterative","Reinforcement"],a:2},
    {q:"K-Means is used for:",opts:["Classification","Regression","Clustering","Prediction"],a:2},
    {q:"Loss function measures:",opts:["Model error","Accuracy","Precision","Recall"],a:0},
    {q:"CNN is best for:",opts:["Text","Image","Audio","Numerical"],a:1},
    {q:"RNNs are good for:",opts:["Independent data","Sequential data","Images","Graphs"],a:1},
    {q:"In ML, ‚Äòepoch‚Äô means:",opts:["One pass over dataset","Model layer","Feature","Output"],a:0},
    {q:"Which one is a hyperparameter?",opts:["Learning rate","Accuracy","Error","Data"],a:0},
    {q:"Which activation for binary output?",opts:["ReLU","Sigmoid","Softmax","Tanh"],a:1},
    {q:"Gradient Descent minimizes:",opts:["Cost function","Output","Data","Features"],a:0},
    {q:"AI stands for:",opts:["Artificial Intelligence","Automated Interface","Applied Integration","None"],a:0},
    {q:"Which is reinforcement learning element?",opts:["Agent","Environment","Reward","All"],a:3},
    {q:"Supervised learning uses:",opts:["Labelled data","Unlabelled data","No data","Rewards"],a:0},
    {q:"Naive Bayes assumes:",opts:["Feature independence","Dependence","No relation","None"],a:0},
    {q:"Which of these is unsupervised?",opts:["Regression","Clustering","Classification","Decision Tree"],a:1},
    {q:"Which is a regression algo?",opts:["Linear Regression","K-Means","Apriori","PCA"],a:0},
    {q:"Dropout prevents:",opts:["Overfitting","Underfitting","Bias","None"],a:0},
    {q:"Transfer learning uses:",opts:["Pre-trained model","Random model","Empty dataset","Manual tuning"],a:0},
    {q:"Which metric for classification?",opts:["Accuracy","MSE","RMSE","MAPE"],a:0},
    {q:"AI focuses on:",opts:["Human-like intelligence","Web design","Hardware","Physics"],a:0}
  ],
  OS:[
    {q:"What is an Operating System?",opts:["Software interface","Hardware","Application","Driver"],a:0},
    {q:"Which manages CPU scheduling?",opts:["Kernel","User","Compiler","Assembler"],a:0},
    {q:"Deadlock occurs when:",opts:["Resources shared","Circular wait","No I/O","None"],a:1},
    {q:"Which is not OS type?",opts:["Batch","Real-time","Multitasking","Binary"],a:3},
    {q:"Which manages files?",opts:["File system","Memory manager","Scheduler","Loader"],a:0},
    {q:"Virtual memory is:",opts:["Logical memory","Physical memory","Cache","Register"],a:0},
    {q:"Critical section problem relates to:",opts:["Synchronization","Compiling","Execution","Paging"],a:0},
    {q:"Semaphore used for:",opts:["Process sync","I/O","Memory","None"],a:0},
    {q:"Paging avoids:",opts:["Fragmentation","Deadlock","Starvation","None"],a:0},
    {q:"Round robin used for:",opts:["Scheduling","Memory","I/O","None"],a:0},
    {q:"Thrashing refers to:",opts:["Excessive paging","Deadlock","Memory leak","None"],a:0},
    {q:"Which command shows processes?",opts:["ps","mv","ls","cd"],a:0},
    {q:"Process to zombie after:",opts:["Exit","Suspend","Run","Load"],a:0},
    {q:"Multithreading improves:",opts:["Concurrency","Latency","Both","None"],a:0},
    {q:"Interrupt handled by:",opts:["ISR","Loader","Compiler","Scheduler"],a:0},
    {q:"Which memory fast?",opts:["Cache","RAM","Disk","ROM"],a:0},
    {q:"Time quantum used in:",opts:["Round Robin","FIFO","SJF","LRU"],a:0},
    {q:"Disk scheduling algorithm:",opts:["FCFS","SSTF","SCAN","All"],a:3},
    {q:"Context switch means:",opts:["Save/restore state","Start process","End program","None"],a:0},
    {q:"System call is:",opts:["Interface b/w user & kernel","API","Compiler","None"],a:0},
    {q:"Which file alloc method fastest?",opts:["Contiguous","Linked","Indexed","Hashed"],a:0},
    {q:"Fragmentation type:",opts:["Internal","External","Both","None"],a:2},
    {q:"Swapping moves:",opts:["Process to disk","File to RAM","None","Cache to CPU"],a:0},
    {q:"Booting means:",opts:["Load OS","Shut down","Restart","None"],a:0},
    {q:"OS acts as:",opts:["Resource manager","Database","Compiler","None"],a:0}
  ],
  OOP:[
    {q:"OOP stands for:",opts:["Object-Oriented Programming","Open Operating Program","Order Output Process","None"],a:0},
    {q:"Encapsulation means:",opts:["Data hiding","Inheritance","Polymorphism","None"],a:0},
    {q:"Inheritance provides:",opts:["Code reuse","Abstraction","Overriding","Encapsulation"],a:0},
    {q:"Polymorphism means:",opts:["Many forms","One form","No form","None"],a:0},
    {q:"Which defines object?",opts:["Class","Function","Variable","Loop"],a:0},
    {q:"Constructor used for:",opts:["Initialize object","Delete object","Overload","None"],a:0},
    {q:"Destructor used for:",opts:["Free memory","Create object","None","Reuse"],a:0},
    {q:"Overloading occurs at:",opts:["Compile time","Run time","Both","None"],a:0},
    {q:"Overriding occurs at:",opts:["Run time","Compile time","None","Both"],a:0},
    {q:"Which supports inheritance?",opts:["C++","C","Assembly","HTML"],a:0},
    {q:"Private members accessible by:",opts:["Class only","All","Derived","None"],a:0},
    {q:"Which keyword for inheritance?",opts:["extends","inherits","super","link"],a:0},
    {q:"Abstraction provides:",opts:["Essential features","All details","Memory","Speed"],a:0},
    {q:"Which OOP feature hides data?",opts:["Encapsulation","Inheritance","Polymorphism","Abstraction"],a:0},
    {q:"Which allows dynamic binding?",opts:["Virtual functions","Static functions","Main","None"],a:0},
    {q:"This pointer used in:",opts:["C++","Java","Python","C"],a:0},
    {q:"Object created from:",opts:["Class","Function","Module","Variable"],a:0},
    {q:"Multiple inheritance means:",opts:["Many parents","Many children","Single parent","None"],a:0},
    {q:"Interface contains:",opts:["Pure virtual methods","Variables","Constructors","None"],a:0},
    {q:"Friend function can access:",opts:["Private data","Public only","None","Protected"],a:0},
    {q:"Dynamic polymorphism by:",opts:["Virtual function","Overloading","Both","None"],a:0},
    {q:"Static polymorphism by:",opts:["Overloading","Overriding","Both","None"],a:0},
    {q:"Base class known as:",opts:["Parent","Child","Derived","None"],a:0},
    {q:"Derived class known as:",opts:["Child","Parent","Abstract","None"],a:0},
    {q:"OOP promotes:",opts:["Modularity","Procedural","Linear","Sequential"],a:0}
  ],
  DBMS:[
    {q:"DBMS stands for:",opts:["Database Management System","Data Backup Manage System","None","Both"],a:0},
    {q:"SQL stands for:",opts:["Structured Query Language","Simple Query List","Sequential Query Logic","None"],a:0},
    {q:"Primary key is:",opts:["Unique identifier","Duplicate","Nullable","None"],a:0},
    {q:"Foreign key links:",opts:["Two tables","Two rows","Two DBs","None"],a:0},
    {q:"Normalization removes:",opts:["Redundancy","Relations","Data","None"],a:0},
    {q:"Which ensures ACID?",opts:["Transaction","Trigger","Cursor","Index"],a:0},
    {q:"Which is DDL command?",opts:["CREATE","INSERT","UPDATE","SELECT"],a:0},
    {q:"Which is DML?",opts:["INSERT","CREATE","ALTER","DROP"],a:0},
    {q:"Which function counts rows?",opts:["COUNT()","SUM()","AVG()","MAX()"],a:0},
    {q:"Which normal form removes transitive dep.?",opts:["3NF","1NF","2NF","BCNF"],a:0},
    {q:"SQL command to remove table?",opts:["DROP","DELETE","TRUNCATE","REMOVE"],a:0},
    {q:"ER model uses:",opts:["Entities","Classes","Objects","Nodes"],a:0},
    {q:"Index improves:",opts:["Query speed","Memory","Storage","None"],a:0},
    {q:"Transaction rollback by:",opts:["ROLLBACK","COMMIT","SAVEPOINT","None"],a:0},
    {q:"Which joins all rows?",opts:["CROSS JOIN","INNER","LEFT","RIGHT"],a:0},
    {q:"Constraint ensures:",opts:["Rules","Speed","None","Memory"],a:0},
    {q:"Aggregate function:",opts:["AVG","IF","ELSE","CASE"],a:0},
    {q:"Query to get all data:",opts:["SELECT *","GET ALL","FETCH","READ"],a:0},
    {q:"Default SQL sorting:",opts:["ASC","DESC","RANDOM","None"],a:0},
    {q:"Which ensures unique?",opts:["UNIQUE","DEFAULT","CHECK","NOT NULL"],a:0},
    {q:"Which gives subset?",opts:["Subquery","Join","Union","None"],a:0},
    {q:"Stored procedures are:",opts:["Precompiled SQL","Runtime","Loop","None"],a:0},
    {q:"Which removes duplicates?",opts:["DISTINCT","ALL","NONE","ONLY"],a:0},
    {q:"DBA stands for:",opts:["Database Admin","Database Application","Database Agent","None"],a:0},
    {q:"Which form of integrity ensures unique key?",opts:["Entity integrity","Referential","Domain","None"],a:0}
  ]
};

// ---------------- FUNCTIONS ----------------
function toggleDark(){document.body.classList.toggle("dark");}

function studentLogin(){
  let id=document.getElementById("userId").value.trim();
  let pass=document.getElementById("userPass").value.trim();
  if(pass===studentPass && id!==""){
    currentUser=id;
    document.getElementById("loginPage").style.display="none";
    document.getElementById("subjectPage").style.display="flex";
  }else alert("Invalid credentials!");
}

function teacherLogin(){
  let pass=document.getElementById("userPass").value.trim();
  if(pass===teacherPass){
    document.getElementById("loginPage").style.display="none";
    document.getElementById("teacherPage").style.display="block";
    loadTeacherTable();
  }else alert("Invalid teacher password!");
}

function startExam(subject){
  currentSubject=subject;
  questions=[...questionBank[subject]].sort(()=>Math.random()-0.5);
  answers=new Array(25).fill(null);
  currentIndex=0;timer=1800;
  document.getElementById("subjectPage").style.display="none";
  document.getElementById("examPage").style.display="flex";
  document.getElementById("examTitle").innerText=subject+" Exam";
  examStart=new Date();
  loadQuestion();startTimer();
}

function loadQuestion(){
  let q=questions[currentIndex];
  let container=document.getElementById("questionContainer");
  container.innerHTML=`
  <div class='question'>${currentIndex+1}. ${q.q}</div>
  <div class='options'>
    ${q.opts.map((opt,i)=>`
      <label class='option-label'>
        <span class='option-tag'>${String.fromCharCode(65+i)}</span>
        <input type='radio' name='option' value='${i}' ${answers[currentIndex]===i?'checked':''} onchange='answers[currentIndex]=${i}'>
        ${opt}
      </label>
    `).join('')}
  </div>`;
}

function nextQuestion(){if(currentIndex<24){currentIndex++;loadQuestion();}}
function prevQuestion(){if(currentIndex>0){currentIndex--;loadQuestion();}}

function startTimer(){
  clearInterval(timerInterval);
  timerInterval=setInterval(()=>{
    timer--;
    let min=Math.floor(timer/60),sec=timer%60;
    document.getElementById("timer").innerText=`Time Left: ${min}:${sec.toString().padStart(2,'0')}`;
    if(timer<=0){clearInterval(timerInterval);submitExam();}
  },1000);
}

function confirmSubmit(){if(confirm("Submit your exam?")) submitExam();}

function submitExam(){
  clearInterval(timerInterval);
  let score=0;
  questions.forEach((q,i)=>{if(answers[i]===q.a)score++;});
  let percent=(score/25)*100;
  showResult(score,percent);
  saveResult(currentUser,currentSubject,score);
}

function showResult(score,percent){
  document.getElementById("examPage").style.display="none";
  document.getElementById("resultPage").style.display="block";
  let fill=document.getElementById("scoreFill");
  let value=document.getElementById("scoreValue");
  let rotation=(percent/100)*360;
  fill.style.transform=`rotate(${rotation}deg)`;
  value.innerText=`${percent.toFixed(0)}%`;
  document.getElementById("resultText").innerHTML=
    `<b>Score:</b> ${score}/25<br>${score>=15?"‚úÖ Passed":"‚ùå Failed - Please Retake Exam"}`;
}

function saveResult(id,sub,score){
  let records=JSON.parse(localStorage.getItem("results")||"[]");
  records.push({id,sub,score,date:new Date().toLocaleString()});
  localStorage.setItem("results",JSON.stringify(records));
}

function loadTeacherTable(){
  let records=JSON.parse(localStorage.getItem("results")||"[]");
  let table=document.getElementById("resultTable");
  table.innerHTML="<tr><th>Student ID</th><th>Subject</th><th>Score</th><th>Date</th></tr>";
  records.forEach(r=>{
    let row=table.insertRow();
    row.insertCell(0).innerText=r.id;
    row.insertCell(1).innerText=r.sub;
    row.insertCell(2).innerText=r.score;
    row.insertCell(3).innerText=r.date;
  });
}

function backToSubjects(){
  document.getElementById("resultPage").style.display="none";
  document.getElementById("subjectPage").style.display="flex";
}

function logout(){
  location.reload();
}
</script>

</body>
</html>
